# Forge app modules configuration
modules:
  # Jira admin pages - accessible from Jira administration settings
  jira:adminPage:
    # Main admin page for Script Master Sandbox
    - key: script-master-sandbox-admin-page
      resource: ui
      title: "Script Master: Sandbox"
      icon: resource:ui;secured-forge-script-master-logo.png
      resolver:
        function: resolver-function
    # Configuration page - used for app setup and configuration
    - key: script-master-sandbox-configure-page
      resource: ui
      title: "Script Master: Sandbox"
      icon: resource:ui;secured-forge-script-master-logo.png
      resolver:
        function: resolver-function
      useAsConfig: true
    # Get started page - shown to users when first installing the app
    - key: script-master-sandbox-get-started-page
      resource: ui
      title: "Script Master: Sandbox"
      icon: resource:ui;secured-forge-script-master-logo.png
      resolver:
        function: resolver-function
      useAsGetStarted: true
  # Confluence global settings - accessible from Confluence administration
  confluence:globalSettings:
    # Main admin page for Confluence
    - key: script-master-sandbox-conf-admin-page
      resource: ui
      title: "Script Master: Sandbox"
      icon: resource:ui;secured-forge-script-master-logo.png
      resolver:
        function: resolver-function
    # Confluence configuration page
    - key: script-master-sandbox-conf-configure-page
      resource: ui
      title: "Script Master: Sandbox"
      icon: resource:ui;secured-forge-script-master-logo.png
      resolver:
        function: resolver-function
      useAsConfig: true
    # Confluence get started page
    - key: script-master-sandbox-conf-get-started-page
      resource: ui
      title: "Script Master: Sandbox"
      icon: resource:ui;secured-forge-script-master-logo.png
      resolver:
        function: resolver-function
      useAsGetStarted: true
  # Web trigger - enables external HTTP requests to trigger app functions
  webtrigger:
    - key: script-master-sandbox-web-trigger
      function: webtrigger-function
  # Function definitions - handlers for various app operations
  function:
    # Resolver function for UI modules
    - key: resolver-function
      handler: index.resolver
    # Handler for web trigger requests
    - key: webtrigger-function
      handler: index.webtrigger
# Static resources served by the app
resources:
  # UI resource - built React application
  - key: ui
    path: ../ui/build
    # Local development tunnel configuration
    tunnel:
      port: 3030
# App permissions and content security policies
permissions:
  # API scopes required by the app
  scopes:
    # Jira API scopes
    - read:jira-user # View user profiles (usernames, emails, avatars)
    - read:jira-work # Read projects, issues, attachments, and worklogs
    - write:jira-work # Create and edit issues, comments, and worklogs
    - manage:jira-project # Manage project settings, versions, and components
    - manage:jira-configuration # Admin actions: create projects, custom fields, workflows
    - manage:jira-webhook # Manage dynamically declared webhooks
    - read:servicedesk-request # View Service Desk requests
    - write:servicedesk-request # Create and manage Service Desk requests
    - manage:servicedesk-customer # Manage Service Desk customers and organizations
    # Confluence API scopes
    - write:confluence-content # Create pages, blogs, comments, and questions
    - write:page:confluence # Special scope for page creation
    - read:confluence-space.summary # Read space information summaries
    - write:confluence-space # Create, update, and delete spaces
    - write:confluence-file # Upload attachments
    - read:confluence-props # Read content properties
    - write:confluence-props # Write content properties
    - manage:confluence-configuration # Manage global settings
    - read:confluence-content.all # Read all content including body with expansions
    - read:confluence-content.summary # Read content summaries without expansions
    - search:confluence # Search Confluence content and spaces
    - read:confluence-content.permission # View content permissions
    - read:confluence-user # View user profiles (usernames, emails, pictures)
    - read:confluence-groups # Retrieve user groups
    - write:confluence-groups # Create, update, and remove user groups
    - readonly:content.attachment:confluence # Download page and blog attachments
    - read:space:confluence # Search for spaces
    - read:page:confluence # Get specific pages
    - delete:page:confluence # Delete pages by ID
    # Shared scopes across Jira and Confluence
    - storage:app # Store and retrieve persistent app data
  # Content Security Policy (CSP) configuration
  content:
    # Script CSP directives - allows inline scripts and eval for development
    scripts:
      - unsafe-inline
      - unsafe-hashes
      - unsafe-eval
    # Style CSP directives - allows inline styles
    styles:
      - unsafe-inline
  # External resource permissions - allows loading resources from external sources
  external:
    images:
      - "*" # Allow all external images
    scripts:
      - "*" # Allow all external scripts
    styles:
      - "*" # Allow all external stylesheets
    fonts:
      - "*" # Allow all external fonts
    frames:
      - "*" # Allow all external frames/iframes
    media:
      - "*" # Allow all external media
    # Fetch API permissions for making external HTTP requests
    fetch:
      backend:
        - "*" # Backend can fetch from any URL
      client:
        - "*" # Client can fetch from any URL
# App configuration and runtime settings
app:
  # Unique app identifier in Atlassian ecosystem
  id: ari:cloud:ecosystem::app/32d0b242-3b4a-4c0c-a0b6-0b44e8280724
  # Runtime environment configuration
  runtime:
    name: nodejs22.x # Node.js version 22
